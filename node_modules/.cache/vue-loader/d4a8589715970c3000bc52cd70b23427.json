{"remainingRequest":"/Users/shuaisujun/Desktop/IOT/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/shuaisujun/Desktop/IOT/src/views/Register.vue?vue&type=style&index=0&lang=css&","dependencies":[{"path":"/Users/shuaisujun/Desktop/IOT/src/views/Register.vue","mtime":1630076146453},{"path":"/Users/shuaisujun/Desktop/IOT/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/shuaisujun/Desktop/IOT/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/shuaisujun/Desktop/IOT/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/shuaisujun/Desktop/IOT/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/shuaisujun/Desktop/IOT/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCi5ib3ggewoJd2lkdGg6IDY1MHB4OwoJdGV4dC1hbGlnbjogY2VudGVyOwoJbWFyZ2luOiAwIGF1dG87Cn0KCmEgewoJdGV4dC1kZWNvcmF0aW9uOiBub25lOwoJY29sb3I6ICM5N2NhZmY7Cn0KCi5idG4ge30K"},{"version":3,"sources":["Register.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA0SA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA","file":"Register.vue","sourceRoot":"src/views","sourcesContent":["<template>\r\n\t<div class=\"box\">\r\n\t\t<h1>IOT平台注册</h1>\r\n\t\t<h4>已有账号,<a href=\"/\">去登陆></a></h4>\r\n\t\t<el-form :model=\"ruleForm\" status-icon :rules=\"rules\" ref=\"ruleForm\" label-width=\"100px\"\r\n\t\t\tstyle=\"text-align: left\">\r\n\t\t\t<el-form-item label=\"手机号/邮箱\" prop=\"phone\">\r\n\t\t\t\t<el-input v-model=\"ruleForm.phone\"></el-input>\r\n\t\t\t\t<el-button type=\"primary\" @click=\"getCode\" class=\"btn\">获取验证码</el-button>\r\n\t\t\t</el-form-item>\r\n\r\n\t\t\t<el-form-item label=\"验证码\" prop=\"code\">\r\n\t\t\t\t<el-input v-model=\"ruleForm.code\"></el-input>\r\n\t\t\t</el-form-item>\r\n\r\n\t\t\t<el-form-item label=\"密码\" prop=\"pass\">\r\n\t\t\t\t<el-input type=\"password\" v-model=\"ruleForm.pass\" autocomplete=\"off\"></el-input>\r\n\t\t\t</el-form-item>\r\n\r\n\t\t\t<el-form-item label=\"确认密码\" prop=\"checkPass\">\r\n\t\t\t\t<el-input type=\"password\" v-model=\"ruleForm.checkPass\" autocomplete=\"off\"></el-input>\r\n\t\t\t</el-form-item>\r\n\r\n\t\t\t<!-- <el-form-item label=\"身份选择\" prop=\"identity\">\r\n\t\t\t\t<el-radio-group v-model=\"ruleForm.identity\">\r\n\t\t\t\t\t<el-radio label=\"管理员\" ></el-radio>\r\n\t\t\t\t\t<el-radio label=\"教师\" ></el-radio>\r\n\t\t\t\t\t<el-radio label=\"学生\" ></el-radio>\r\n\t\t\t\t</el-radio-group>\r\n\t\t\t</el-form-item> -->\r\n\r\n\t\t\t<el-form-item>\r\n\t\t\t\t<el-button type=\"primary\" @click=\"submit\">立即注册</el-button>\r\n\t\t\t\t<el-button @click=\"resetForm('ruleForm')\">重置</el-button>\r\n\t\t\t</el-form-item>\r\n\t\t</el-form>\r\n\t</div>\r\n</template>\r\n\r\n<script>\r\n\timport axios from 'axios'\r\n\timport Qs from 'qs';\r\n\timport sha256 from 'js-sha256';\r\n\texport default {\r\n\t\tdata() {\r\n\t\t\tvar validatePass = (rule, value, callback) => {\r\n\t\t\t\tif (value === '') {\r\n\t\t\t\t\tcallback(new Error('请输入密码'))\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (this.ruleForm.checkPass !== '') {\r\n\t\t\t\t\t\tthis.$refs.ruleForm.validateField('checkPass')\r\n\t\t\t\t\t}\r\n\t\t\t\t\tcallback()\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tvar validatePass2 = (rule, value, callback) => {\r\n\t\t\t\tif (value === '') {\r\n\t\t\t\t\tcallback(new Error('请再次输入密码'))\r\n\t\t\t\t} else if (value !== this.ruleForm.pass) {\r\n\t\t\t\t\tcallback(new Error('两次输入密码不一致!'))\r\n\t\t\t\t} else {\r\n\t\t\t\t\tcallback()\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn {\r\n\t\t\t\tuser_id: '',\r\n\t\t\t\ttoken: '',\r\n\t\t\t\tcompany_id:'',\r\n\t\t\t\tmodal:'',\r\n\t\t\t\tway: false,\r\n\t\t\t\truleForm: {\r\n\t\t\t\t\tpass: '',\r\n\t\t\t\t\tcheckPass: '',\r\n\t\t\t\t\tcode: '',\r\n\t\t\t\t\t// identity: '',\r\n\t\t\t\t\tphone: '',\r\n\t\t\t\t\tsms_id: '',\r\n\t\t\t\t},\r\n\t\t\t\trules: {\r\n\t\t\t\t\tpass: [{\r\n\t\t\t\t\t\t\tvalidator: validatePass,\r\n\t\t\t\t\t\t\ttrigger: 'blur'\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\trequired: true,\r\n\t\t\t\t\t\t\tmessage: '请输入密码',\r\n\t\t\t\t\t\t\ttrigger: 'blur'\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t],\r\n\t\t\t\t\tcheckPass: [{\r\n\t\t\t\t\t\t\tvalidator: validatePass2,\r\n\t\t\t\t\t\t\ttrigger: 'blur'\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\trequired: true,\r\n\t\t\t\t\t\t\tmessage: '确认密码',\r\n\t\t\t\t\t\t\ttrigger: 'blur'\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t],\r\n\t\t\t\t\t// identity:[\r\n\t\t\t\t\t// \t{ required: true, message: '选择身份类型', trigger: 'change'},\r\n\t\t\t\t\t// ],\r\n\t\t\t\t\tphone: [{\r\n\t\t\t\t\t\trequired: true,\r\n\t\t\t\t\t\tmessage: '请输入手机号/邮箱',\r\n\t\t\t\t\t\ttrigger: 'blur'\r\n\t\t\t\t\t}, ],\r\n\t\t\t\t\tcode: [{\r\n\t\t\t\t\t\trequired: true,\r\n\t\t\t\t\t\tmessage: '请输入验证码',\r\n\t\t\t\t\t\ttrigger: 'blur'\r\n\t\t\t\t\t}, ],\r\n\t\t\t\t},\r\n\t\t\t}\r\n\t\t},\r\n\t\tmounted() {\r\n\t\t\t// this.getNameCookie();\r\n\t\t\tthis.getIdCookier();\r\n\t\t\tif(this.user_id!==''&&this.token!==''&&this.company_id!==''&&this.modal!==''){\r\n\t\t\t\tthis.$router.push({\r\n\t\t\t\t\tname: 'MainPage',\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t},\r\n\t\tmethods: {\r\n\r\n\t\t\t//提交表单函数\r\n\t\t\tsubmit() {\r\n\t\t\t\tlet sha256 = require(\"js-sha256\").sha256 //这里用的是require方法\r\n\t\t\t\tvar sha256password = sha256(this.ruleForm.pass) //要加密的密码\r\n\t\t\t\t// console.log(this.sha256password)//这就是你加密之后的密码\r\n\t\t\t\tvar data;\r\n\t\t\t\tif (/^(0|86|17951)?(13[0-9]|15[012356789]|17[0-8]|18[0-9]|14[5679]|19[189]|16[56])[0-9]{8}$/.test(this.ruleForm.phone)) {\r\n\t\t\t\t\tdata = {\r\n\t\t\t\t\t\t\"requestCode\": \"002\",\r\n\t\t\t\t\t\t\"phoneNumber\": this.ruleForm.phone,\r\n\t\t\t\t\t\t\"code\": this.ruleForm.code,\r\n\t\t\t\t\t\t\"sms_id\": this.ruleForm.sms_id,\r\n\t\t\t\t\t\t\"password\": sha256password,\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (/^([a-zA-Z0-9_-])+@([a-zA-Z0-9_-])+(.[a-zA-Z0-9_-])+$/.test(this.ruleForm.phone)) {\r\n\t\t\t\t\tdata = {\r\n\t\t\t\t\t\t\"requestCode\": \"004\",\r\n\t\t\t\t\t\t\"address\": this.ruleForm.phone,\r\n\t\t\t\t\t\t\"code\": this.ruleForm.code,\r\n\t\t\t\t\t\t\"sms_id\": this.ruleForm.sms_id,\r\n\t\t\t\t\t\t\"password\": sha256password,\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tconsole.log('输入非手机号或者邮箱');\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tlet _this = this;\r\n\t\t\t\tvar url = 'https://site.maple.today/IOTplatform/SMS';\r\n\t\t\t\t\r\n\t\t\t\tvar AXIOS = axios.create({\r\n\t\t\t\t\theaders: {\r\n\t\t\t\t\t\t'Content-Type': 'application/x-www-form-urlencoded'\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tAXIOS.post(url, Qs.stringify(data))\r\n\t\t\t\t\t.then(res => {\r\n\t\t\t\t\t\tif (res.data.result === \"1\") {\r\n\t\t\t\t\t\t\tconsole.log('注册成功');\r\n\t\t\t\t\t\t\t_this.setIdCookie(res.data.user_id,res.data.token,res.data.company,res.data.modal,1);\r\n\t\t\t\t\t\t\t_this.$router.push({\r\n\t\t\t\t\t\t\t\tname:'MainPage',\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t} else if (res.data.result === \"0\") {\r\n\t\t\t\t\t\t\talert('未知错误')\r\n\t\t\t\t\t\t} else if (res.data.result === \"2\") {\r\n\t\t\t\t\t\t\talert('超时或验证码错误')\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.catch(error => console.log(error));\r\n\t\t\t},\r\n\r\n\t\t\t//清空表单\r\n\t\t\tresetForm(ruleForm) {\r\n\t\t\t\tthis.$refs[ruleForm].resetFields();\r\n\t\t\t},\r\n\r\n\t\t\t//获取验证码函数\r\n\t\t\tgetCode() {\r\n\t\t\t\tlet _this = this;\r\n\t\t\t\tvar url;\r\n\t\t\t\tvar data;\r\n\t\t\t\tif (/^(0|86|17951)?(13[0-9]|15[012356789]|17[0-8]|18[0-9]|14[5679]|19[189]|16[56])[0-9]{8}$/.test(this.ruleForm.phone)) {\r\n\t\t\t\t\turl = 'https://site.maple.today/IOTplatform/SMS';\r\n\t\t\t\t\tdata = {\r\n\t\t\t\t\t\t\"requestCode\": \"001\",\r\n\t\t\t\t\t\t\"phoneNumber\": this.ruleForm.phone,\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (/^([a-zA-Z0-9_-])+@([a-zA-Z0-9_-])+(.[a-zA-Z0-9_-])+$/.test(this.ruleForm.phone)) {\r\n\t\t\t\t\turl = 'https://site.maple.today/IOTplatform/SMS';\r\n\t\t\t\t\tdata = {\r\n\t\t\t\t\t\t\"requestCode\": \"003\",\r\n\t\t\t\t\t\t\"address\": this.ruleForm.phone,\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tconsole.log('输入非手机号或者邮箱');\r\n\t\t\t\t}\r\n\r\n\t\t\t\t\r\n\t\t\t\tconsole.log(Qs.stringify(data))\r\n\t\t\t\tvar AXIOS = axios.create({\r\n\t\t\t\t\theaders: {\r\n\t\t\t\t\t\t'Content-Type': 'application/x-www-form-urlencoded'\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tAXIOS.post(url, Qs.stringify(data))\r\n\t\t\t\t\t.then(res => {\r\n\t\t\t\t\t\tif (res.data.result === \"1\") {\r\n\t\t\t\t\t\t\t_this.ruleForm.sms_id = res.data.sms_id;\r\n\t\t\t\t\t\t\tconsole.log(_this.ruleForm.sms_id);\r\n\t\t\t\t\t\t} else if (res.data.result === \"0\") {\r\n\t\t\t\t\t\t\talert('超出本日短信上限')\r\n\t\t\t\t\t\t} else if (res.data.result === \"2\") {\r\n\t\t\t\t\t\t\talert('请求过于频繁，1分钟后再请求')\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\tconsole.log(res)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.catch(error => console.log(error));\r\n\t\t\t},\r\n\t\t\t//设置setNameCookie\r\n\t\t\tsetNameCookie(c_name, c_pwd, exdays) {\r\n\t\t\t\tvar exdate = new Date() //获取时间\r\n\t\t\t\texdate.setTime(exdate.getTime() + 24 * 60 * 60 * 1000 * exdays) //保存的天数\r\n\t\t\t\t//字符串拼接cookie\r\n\t\t\t\twindow.document.cookie = 'userName' + '=' + c_name + ';path=/;expires=' + exdate.toGMTString()\r\n\t\t\t\twindow.document.cookie = 'userPwd' + '=' + c_pwd + ';path=/;expires=' + exdate.toGMTString()\r\n\t\t\t},\r\n\t\t\tsetIdCookie(c_id,c_token,c_companyid,c_modal,exdays){\r\n\t\t\t\t//c_id是用户id\r\n\t\t\t\t//c_token是token验证\r\n\t\t\t\t//c_companyid是用户的公司id\r\n\t\t\t\t//c_modal是用户的身份类型\r\n\t\t\t\tvar exdate = new Date() //获取时间\r\n\t\t\t\texdate.setTime(exdate.getTime() + 24 * 60 * 60 * 1000 * exdays) //保存的天数\r\n\t\t\t\t//字符串拼接cookie\r\n\t\t\t\twindow.document.cookie = 'user_id' + '=' + c_id + ';path=/;expires=' + exdate.toGMTString()\r\n\t\t\t\twindow.document.cookie = 'token' + '=' + c_token + ';path=/;expires=' + exdate.toGMTString()\r\n\t\t\t\twindow.document.cookie = 'company_id' + '=' + c_companyid + ';path=/;expires=' + exdate.toGMTString()\r\n\t\t\t\twindow.document.cookie = 'modal' + '=' + c_modal + ';path=/;expires=' + exdate.toGMTString()\r\n\t\t\t},\r\n\t\t\t//读取cookie\r\n\t\t\tgetNameCookie: function() {\r\n\t\t\t\tif (document.cookie.length > 0) {\r\n\t\t\t\t\tthis.checked = true\r\n\t\t\t\t\t// console.log(document.cookie)\r\n\t\t\t\t\tvar arr = document.cookie.split('; ') //这里显示的格式需要切割一下自己可输出看下\r\n\t\t\t\t\tfor (var i = 0; i < arr.length; i++) {\r\n\t\t\t\t\t\tvar arr2 = arr[i].split('=') //再次切割\r\n\t\t\t\t\t\t//判断查找相对应的值\r\n\t\t\t\t\t\tif (arr2[0] === 'userName') {\r\n\t\t\t\t\t\t\tthis.ruleForm.name = arr2[1] //保存到保存数据的地方\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (arr2[0] === 'userPwd') {\r\n\t\t\t\t\t\t\tthis.ruleForm.password = arr2[1]\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tgetIdCookier: function(){\r\n\t\t\t\tif (document.cookie.length > 0) {\r\n\t\t\t\t\t// console.log(document.cookie)\r\n\t\t\t\t\tvar arr = document.cookie.split('; ') //这里显示的格式需要切割一下自己可输出看下\r\n\t\t\t\t\tfor (var i = 0; i < arr.length; i++) {\r\n\t\t\t\t\t\tvar arr2 = arr[i].split('=') //再次切割\r\n\t\t\t\t\t\t//判断查找相对应的值\r\n\t\t\t\t\t\tif (arr2[0] === 'user_id') {\r\n\t\t\t\t\t\t\tthis.user_id = arr2[1] //保存到保存数据的地方\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (arr2[0] === 'token') {\r\n\t\t\t\t\t\t\tthis.token = arr2[1]\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (arr2[0] === 'company_id') {\r\n\t\t\t\t\t\t\tthis.company_id = arr2[1]\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (arr2[0] === 'modal') {\r\n\t\t\t\t\t\t\tthis.modal = arr2[1]\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t//清除cookie\r\n\t\t\tclearNameCookie: function() {\r\n\t\t\t\tthis.setNameCookie('', '', -1) //修改2值都为空，天数为负1天就好了\r\n\t\t\t},\r\n\t\t\tclearIdCookie: function() {\r\n\t\t\t\tthis.setIdCookie('', '','','', -1) //修改2值都为空，天数为负1天就好了\r\n\t\t\t},\r\n\t\t},\r\n\t}\r\n</script>\r\n<style>\r\n\t.box {\r\n\t\twidth: 650px;\r\n\t\ttext-align: center;\r\n\t\tmargin: 0 auto;\r\n\t}\r\n\r\n\ta {\r\n\t\ttext-decoration: none;\r\n\t\tcolor: #97caff;\r\n\t}\r\n\r\n\t.btn {}\r\n</style>\n"]}]}