{"remainingRequest":"/Users/maple/Desktop/file/netplus/开发/IOT/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/maple/Desktop/file/netplus/开发/IOT/src/views/Loading.vue?vue&type=style&index=0&lang=css&","dependencies":[{"path":"/Users/maple/Desktop/file/netplus/开发/IOT/src/views/Loading.vue","mtime":1630232792000},{"path":"/Users/maple/Desktop/file/netplus/开发/IOT/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/maple/Desktop/file/netplus/开发/IOT/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/maple/Desktop/file/netplus/开发/IOT/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/maple/Desktop/file/netplus/开发/IOT/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/maple/Desktop/file/netplus/开发/IOT/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCi5sb2dpbkJveCB7Cglwb3NpdGlvbjogYWJzb2x1dGU7CgloZWlnaHQ6IDEwMCU7Cgl3aWR0aDogMTAwJTsKCS8qIGJhY2tncm91bmQ6IHBpbms7ICovCgltYXJnaW46IDA7CglkaXNwbGF5OiBmbGV4OwoJanVzdGlmeS1jb250ZW50OiBjZW50ZXI7CglhbGlnbi1pdGVtczogY2VudGVyOwp9CgoubG9naW5Db250YWluZXIgewoJd2lkdGg6IDQ4MHB4OwoJYmFja2dyb3VuZDogd2hpdGU7CglkaXNwbGF5OiBmbGV4OwoJZmxleC1kaXJlY3Rpb246IGNvbHVtbjsKCWFsaWduLWl0ZW1zOiBjZW50ZXI7Cglib3JkZXItcmFkaXVzOiA2cHg7Cn0KCmgyIHsKCW1hcmdpbi1ib3R0b206IDUwcHg7CgltYXJnaW4tdG9wOiA1MHB4Owp9CgoubG9naW4gewoJd2lkdGg6IDQwMHB4OwoJbWFyZ2luLWJvdHRvbTogNTBweDsKfQo="},{"version":3,"sources":["Loading.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAuMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA","file":"Loading.vue","sourceRoot":"src/views","sourcesContent":["<template>\r\n\t<div class=\"loginBox\">\r\n\t\t<div class=\"loginContainer\">\r\n\t\t\t<div style=\"text-align: left; width: 400px\">\r\n\t\t\t\t<h2>登录</h2>\r\n\t\t\t</div>\r\n\t\t\t<div class=\"login\">\r\n\t\t\t\t<el-form ref=\"form\" :model=\"form\">\r\n\t\t\t\t\t<el-form-item>\r\n\t\t\t\t\t\t<el-input v-model=\"form.name\" placeholder=\"手机号/邮箱\"></el-input>\r\n\t\t\t\t\t</el-form-item>\r\n\t\t\t\t\t<el-form-item>\r\n\t\t\t\t\t\t<el-input v-model=\"form.password\" placeholder=\"密码\" show-password></el-input>\r\n\t\t\t\t\t</el-form-item>\r\n\t\t\t\t\t<el-form-item>\r\n\t\t\t\t\t\t<el-checkbox style=\"float: left\" label=\"记住密码\" v-model=\"checked\"></el-checkbox>\r\n\t\t\t\t\t</el-form-item>\r\n\t\t\t\t\t<el-form-item>\r\n\t\t\t\t\t\t<el-button type=\"primary\" style=\"width: 400px\" @click=\"loading()\"> 登录 </el-button>\r\n\t\t\t\t\t</el-form-item>\r\n\t\t\t\t\t<el-form-item>\r\n\t\t\t\t\t\t<el-button type=\"primary\" style=\"width: 400px\" @click=\"register()\"> 注册 </el-button>\r\n\t\t\t\t\t</el-form-item>\r\n\t\t\t\t</el-form>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n</template>\r\n\r\n<script>\r\n\timport sha256 from 'js-sha256'\r\n\timport axios from 'axios'\r\n\timport Qs from 'qs'\r\n\texport default {\r\n\t\tname: 'Loading',\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\ttoken: '',\r\n\t\t\t\tuser_id: '',\r\n\t\t\t\tchecked: false,\r\n\t\t\t\tform: {\r\n\t\t\t\t\tname: '',\r\n\t\t\t\t\tpassword: '',\r\n\t\t\t\t},\r\n\t\t\t}\r\n\t\t},\r\n\t\tmounted() {\r\n\t\t\tthis.getNameCookie();\r\n\t\t\tthis.getIdCookier();\r\n\t\t\tif(this.user_id!==''&&this.token!==''&&this.company_id!==''&&this.modal!==''){\r\n\t\t\t\tthis.$router.push('/mainPage/dataInformation')\r\n\t\t\t}\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\t//登录函数\r\n\t\t\tloading() {\r\n\t\t\t\tlet _this = this\r\n\r\n\t\t\t\tlet sha256 = require(\"js-sha256\").sha256 //这里用的是require方法，所以没用import\r\n\t\t\t\tvar sha256password = sha256(this.form.password) //要加密的密码\r\n\t\t\t\t// console.log(sha256password)//这就是你加密之后的密码\r\n\r\n\t\t\t\tvar way;\r\n\t\t\t\tif (/^(0|86|17951)?(13[0-9]|15[012356789]|17[0-8]|18[0-9]|14[5679]|19[189]|16[56])[0-9]{8}$/.test(this.form.name)) {\r\n\t\t\t\t\tway = 1;\r\n\t\t\t\t} else if (/^([a-zA-Z0-9_-])+@([a-zA-Z0-9_-])+(.[a-zA-Z0-9_-])+$/.test(this.form.name)) {\r\n\t\t\t\t\tway = 2;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tway = 3;\r\n\t\t\t\t\tconsole.log('输入账号非手机号或者邮箱');\r\n\t\t\t\t}\r\n\t\t\t\t// console.log(way);\r\n\r\n\t\t\t\tif (this.form.name === '' || this.form.password === '') {\r\n\t\t\t\t\talert('账号或密码不能为空')\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (_this.checked) {\r\n\t\t\t\t\t\t_this.setNameCookie(_this.form.name, _this.form.password, 7)\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t_this.clearNameCookie()\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tvar url = 'https://site.maple.today/IOTplatform/ServerMain';\r\n\t\t\t\t\tlet data = {\r\n\t\t\t\t\t\t\"requestCode\": \"002\",\r\n\t\t\t\t\t\t\"account\": this.form.name,\r\n\t\t\t\t\t\t\"loginway\": way,\r\n\t\t\t\t\t\t\"password\": sha256password,\r\n\t\t\t\t\t};\r\n\t\t\t\t\tconsole.log(Qs.stringify(data));\r\n\t\t\t\t\tvar AXIOS = axios.create({\r\n\t\t\t\t\t\theaders: {\r\n\t\t\t\t\t\t\t'Content-Type': 'application/x-www-form-urlencoded'\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\tAXIOS.post(url, Qs.stringify(data))\r\n\t\t\t\t\t\t.then(res => {\r\n\t\t\t\t\t\t\tif (res.data.result === \"1\") {\r\n\t\t\t\t\t\t\t\tconsole.log('登录成功');\r\n\t\t\t\t\t\t\t\tconsole.log(res);\r\n\t\t\t\t\t\t\t\t_this.setIdCookie(res.data.user_id,res.data.token,res.data.company,res.data.modal,this.form.password,1);\r\n\t\t\t\t\t\t\t\t// _this.$router.push({\r\n\t\t\t\t\t\t\t\t// \tname:'MainPage',\r\n\t\t\t\t\t\t\t\t// })\n\t\t\t\t\t\t\t\t_this.$router.push('/mainPage/dataInformation')\r\n\t\t\t\t\t\t\t} else if (res.data.result === \"0\") {\r\n\t\t\t\t\t\t\t\talert('该用户未注册')\r\n\t\t\t\t\t\t\t} else if (res.data.result === \"2\") {\r\n\t\t\t\t\t\t\t\talert('密码错误')\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\tconsole.log(res)\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t.catch(error => console.log(error));\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t//注册函数\r\n\t\t\tregister() {\r\n\t\t\t\tthis.$router.push({\r\n\t\t\t\t\tname: 'Register',\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t//设置setNameCookie\r\n\t\t\tsetNameCookie(c_name, c_pwd, exdays) {\r\n\t\t\t\tvar exdate = new Date() //获取时间\r\n\t\t\t\texdate.setTime(exdate.getTime() + 24 * 60 * 60 * 1000 * exdays) //保存的天数\r\n\t\t\t\t//字符串拼接cookie\r\n\t\t\t\twindow.document.cookie = 'userName' + '=' + c_name + ';path=/;expires=' + exdate.toGMTString()\r\n\t\t\t\twindow.document.cookie = 'userPwd' + '=' + c_pwd + ';path=/;expires=' + exdate.toGMTString()\r\n\t\t\t},\r\n\t\t\tsetIdCookie(c_id,c_token,c_companyid,c_modal,c_password,exdays){\r\n\t\t\t\t//c_id是用户id\r\n\t\t\t\t//c_token是token验证\r\n\t\t\t\t//c_companyid是用户的公司id\r\n\t\t\t\t//c_modal是用户的身份类型\r\n\t\t\t\tvar exdate = new Date() //获取时间\r\n\t\t\t\texdate.setTime(exdate.getTime() + 24 * 60 * 60 * 1000 * exdays) //保存的天数\r\n\t\t\t\t//字符串拼接cookie\r\n\t\t\t\twindow.document.cookie = 'user_id' + '=' + c_id + ';path=/;expires=' + exdate.toGMTString()\r\n\t\t\t\twindow.document.cookie = 'token' + '=' + c_token + ';path=/;expires=' + exdate.toGMTString()\r\n\t\t\t\twindow.document.cookie = 'company_id' + '=' + c_companyid + ';path=/;expires=' + exdate.toGMTString()\r\n\t\t\t\twindow.document.cookie = 'modal' + '=' + c_modal + ';path=/;expires=' + exdate.toGMTString()\r\n\t\t\t\twindow.document.cookie = 'password' + '=' + c_password + ';path=/;expires=' + exdate.toGMTString()\r\n\t\t\t},\r\n\t\t\t//读取cookie\r\n\t\t\tgetNameCookie: function() {\r\n\t\t\t\tif (document.cookie.length > 0) {\r\n\t\t\t\t\tthis.checked = true\r\n\t\t\t\t\t// console.log(document.cookie)\r\n\t\t\t\t\tvar arr = document.cookie.split('; ') //这里显示的格式需要切割一下自己可输出看下\r\n\t\t\t\t\tfor (var i = 0; i < arr.length; i++) {\r\n\t\t\t\t\t\tvar arr2 = arr[i].split('=') //再次切割\r\n\t\t\t\t\t\t//判断查找相对应的值\r\n\t\t\t\t\t\tif (arr2[0] === 'userName') {\r\n\t\t\t\t\t\t\tthis.form.name = arr2[1] //保存到保存数据的地方\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (arr2[0] === 'userPwd') {\r\n\t\t\t\t\t\t\tthis.form.password = arr2[1]\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tgetIdCookier: function(){\r\n\t\t\t\tif (document.cookie.length > 0) {\r\n\t\t\t\t\t// console.log(document.cookie)\r\n\t\t\t\t\tvar arr = document.cookie.split('; ') //这里显示的格式需要切割一下自己可输出看下\r\n\t\t\t\t\tfor (var i = 0; i < arr.length; i++) {\r\n\t\t\t\t\t\tvar arr2 = arr[i].split('=') //再次切割\r\n\t\t\t\t\t\t//判断查找相对应的值\r\n\t\t\t\t\t\tif (arr2[0] === 'user_id') {\r\n\t\t\t\t\t\t\tthis.user_id = arr2[1] //保存到保存数据的地方\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (arr2[0] === 'token') {\r\n\t\t\t\t\t\t\tthis.token = arr2[1]\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (arr2[0] === 'company_id') {\r\n\t\t\t\t\t\t\tthis.company_id = arr2[1]\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (arr2[0] === 'modal') {\r\n\t\t\t\t\t\t\tthis.modal = arr2[1]\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t//清除cookie\r\n\t\t\tclearNameCookie: function() {\r\n\t\t\t\tthis.setNameCookie('', '', -1) //修改2值都为空，天数为负1天就好了\r\n\t\t\t},\r\n\t\t\tclearIdCookie: function() {\r\n\t\t\t\tthis.setIdCookie('', '','','','', -1) //修改2值都为空，天数为负1天就好了\r\n\t\t\t},\r\n\t\t},\r\n\t}\r\n</script>\r\n\r\n<style>\r\n\t.loginBox {\r\n\t\tposition: absolute;\r\n\t\theight: 100%;\r\n\t\twidth: 100%;\r\n\t\t/* background: pink; */\r\n\t\tmargin: 0;\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: center;\r\n\t\talign-items: center;\r\n\t}\r\n\r\n\t.loginContainer {\r\n\t\twidth: 480px;\r\n\t\tbackground: white;\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\talign-items: center;\r\n\t\tborder-radius: 6px;\r\n\t}\r\n\r\n\th2 {\r\n\t\tmargin-bottom: 50px;\r\n\t\tmargin-top: 50px;\r\n\t}\r\n\r\n\t.login {\r\n\t\twidth: 400px;\r\n\t\tmargin-bottom: 50px;\r\n\t}\r\n</style>\n"]}]}